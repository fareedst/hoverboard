ARCH-LOCAL_BOOKMARKS_INDEX:
  name: Local Bookmarks Index Architecture
  status: Active
  cross_references: &ref_0 []
  rationale:
    why: See detail file
    problems_solved: []
    benefits: []
  alternatives_considered: []
  implementation_approach:
    summary: 'A **single extension page** (e.g. `bookmarks-table.html`) displays a table of **local, file, and sync bookmarks** (non-Pinboard). Data from **getAggregatedBookmarksForIndex** (or fallback **getLocalBookmarksForIndex**). Toolbar: **Stores**; **Show only** (tags, to-read, private, time range, **Clear** button); **Table Display** (Time column, Time format); **Hide**. Filter pipeline: stores → search → show-only → hide. **Actions for selected** (below table): Export, Move, **Delete** (confirmation), Import. **Compact layout** to maximize table space. Table: **Select** column, **Storage** column, **Time** column, sortable columns, **launchable URLs** with **external-link indicator**. Empty state when no store checked or no data.'
    details: []
  traceability:
    requirements: *ref_0
    implementation: []
    tests: []
    code_annotations:
      - ARCH-LOCAL_BOOKMARKS_INDEX
  related_decisions:
    depends_on: *ref_0
    informs: []
    see_also: []
  detail_file: architecture-decisions/ARCH-LOCAL_BOOKMARKS_INDEX.yaml
  metadata:
    created:
      date: '2026-02-18'
      author: MCP converter
    last_updated:
      date: '2026-02-20'
      author: Agent
      reason: Local Bookmarks Index UI groups and Delete
    last_validated:
      date: '2026-02-18'
      validator: MCP converter
      result: pass
  decision: 'A **single extension page** (e.g. `bookmarks-table.html`) displays a table of **local, file, and sync bookmarks** (non-Pinboard). Data from **getAggregatedBookmarksForIndex** (or fallback **getLocalBookmarksForIndex**). **Stores** group: Local, File, Sync checkboxes; default all unchecked. **Show only** group: tags include, to-read, private, time range (Start/End, time field); **Clear** button resets Show only to defaults. **Table Display** group: Time column (Create time | Last updated), Time format (Absolute | Age). **Hide** group: tags exclude. **Compact layout** (reduced whitespace) to maximize table space. **Actions for selected**: Export, Move, **Delete** (confirmation; if ≤8 selected, show names), Import. Table: **Select** column, **Storage** column, **Time** column [REQ-BOOKMARK_CREATE_UPDATE_TIMES], **search**, sortable columns, **launchable URLs** with **external-link indicator**. Empty state when no store checked or no data.'
  cross-references: REQ-LOCAL_BOOKMARKS_INDEX, IMPL-LOCAL_BOOKMARKS_INDEX, ARCH-STORAGE_INDEX_AND_ROUTER
  filters: '**Stores** (checkboxes Local/File/Sync; empty set → 0 rows). **Show only:** tag include, to-read, private, time range (Start/End, time field Create time | Last updated); **Clear** resets Show only to defaults. **Hide:** tags exclude. All client-side; applied in order: stores → search → show-only → hide.'
  getaggregatedbookmarksforindex: 'Handled by calling `bookmarkProvider.getAllBookmarksForIndex()` when the provider is BookmarkRouter; router aggregates local, file, and sync providers, adds `storage: ''local''` | ''file'' | ''sync'', merges and sorts by time desc.'
  getlocalbookmarksforindex: 'Fallback when aggregated is unavailable; uses LocalBookmarkService directly, returns local bookmarks only (index page tags each with `storage: ''local''`).'
  launch: 'URL column is `<a href="..." target="_blank" rel="noopener">` with **external-link indicator** (e.g. ↗) and title "Opens in new tab".'
  selection: 'First column **Select**: checkboxes per row, header "select all" for visible rows. Selected URLs kept in a Set for bulk operations.'
  bulk_move: '**Move selected to** (Local | File | Sync) + Move button; uses existing moveBookmarkToStorage message per selected URL [REQ-MOVE_BOOKMARK_STORAGE_UI]. Move controls disabled when no selection; enabled when one or more bookmarks selected.'
  bulk_delete: '**Delete** button in Actions for selected; confirmation shows record count; if ≤8 selected, bookmark names listed. Uses deleteBookmark message per selected URL; table refreshes and selection clears after delete.'
  related:
    - IMPL-LOCAL_BOOKMARKS_INDEX (getAggregatedBookmarksForIndex / getLocalBookmarksForIndex, handler, bookmarks-table UI with Storage column)
    - ARCH-STORAGE_INDEX_AND_ROUTER (BookmarkRouter, getAllBookmarksForIndex)
    - ARCH-LOCAL_STORAGE_PROVIDER (LocalBookmarkService strategy)
    - ARCH-MESSAGE_HANDLING (message routing)
  search: One text input; case-insensitive substring match on description, url, tags (joined), extended.
  sort: 'Click column header to sort; toggle asc/desc. Columns: **Select**, Title, URL, Tags, Time, **Storage** (Local | File | Sync), Shared, To read. Default sort: time descending. When sorting by Time, the effective key is the selected time source (create-time or last-updated).'
  time_column: 'Single **Time** column; **Table Display** toolbar group contains **Time column** (Create time | Last updated) and **Time format** (Absolute: YYYY-MM-DD HH:mm:ss | Age: two largest units). [REQ-BOOKMARK_CREATE_UPDATE_TIMES].'
  show_only_clear: '**Show only** group includes a **Clear** button that resets all controls in that group to default (empty tags, to-read and private unchecked, time range cleared, time field = Last updated).'
  layout: 'Page uses **compact layout**: reduced padding and margins (e.g. --space-2, --space-3) for container, header, toolbar, toolbar groups, filters row, actions group, and table wrapper so the table receives maximum space.'
  summary: 'A **single extension page** (e.g. `bookmarks-table.html`) displays a table of **local, file, and sync bookmarks** (non-Pinboard). Data from **getAggregatedBookmarksForIndex** (or fallback **getLocalBookmarksForIndex**). **Stores** group (Local, File, Sync checkboxes; default all unchecked). **Show only** (tags include, to-read, private, time range; **Clear** button). **Table Display** group (Time column, Time format). **Hide** (tags exclude). **Actions for selected** (Export, Move, **Delete** with confirmation, Import). **Compact layout** to maximize table space. Table: **Select** column, **Storage** column, **Time** column, **search**, sortable columns, **launchable URLs** with **external-link indicator**. Empty state when no store checked or no data.'
