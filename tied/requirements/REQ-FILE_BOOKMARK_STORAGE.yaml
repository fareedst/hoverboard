REQ-FILE_BOOKMARK_STORAGE:
  name: File-Based Bookmark Storage
  category: Functional
  priority: P1
  status: Planned
  rationale:
    why: See detail file
    problems_solved: []
    benefits: []
  satisfaction_criteria:
    - criterion: 'File-based provider exposes: getBookmarkForUrl, getRecentBookmarks, saveBookmark, deleteBookmark, saveTag, deleteTag, testConnection.'
    - criterion: 'File format: `{ "version": 1, "bookmarks": { "<url>": { bookmark object } } }`; same bookmark shape as local (url, description, extended, tags, time, shared, toread, hash).'
    - criterion: File I/O is behind an abstraction (adapter) so the module is testable with a mocked/in-memory adapter.
  validation_criteria:
    - method: 'Unit tests with mocked adapter: save/get/delete, getRecentBookmarks order, saveTag/deleteTag, edge cases (empty file, missing URL, invalid JSON).'
  traceability:
    architecture: []
    implementation: []
    tests: []
    code_annotations:
      - REQ-FILE_BOOKMARK_STORAGE
  related_requirements:
    depends_on: []
    related_to: []
    supersedes: []
  detail_file: requirements/REQ-FILE_BOOKMARK_STORAGE.yaml
  metadata:
    created:
      date: '2026-02-18'
      author: MCP converter
    last_updated:
      date: '2026-02-18'
      author: MCP converter
      reason: Converted from monolithic
    last_validated:
      date: '2026-02-18'
      validator: MCP converter
      result: pass
  cross-references: ARCH-FILE_BOOKMARK_PROVIDER, IMPL-FILE_BOOKMARK_SERVICE
  purpose:
    - Enable storing bookmarks in a folder that can be cloud-synchronized (e.g. Dropbox, Drive).
    - Allow sharing the bookmark file with ad-hoc groups.
    - Keep one file per directory for simple conflict semantics (last-write-wins when synced).
  related:
    - ARCH-FILE_BOOKMARK_PROVIDER (architecture for file provider and adapter)
    - IMPL-FILE_BOOKMARK_SERVICE (implementation and file format)
    - REQ-STORAGE_MODE_DEFAULT (existing storage modes)
  summary: 'The extension supports a third bookmark storage backend: **file-based**. Bookmarks are stored in a **single user-chosen directory** in a **single file** (e.g. `hoverboard-bookmarks.json`) in a format suitable for **cloud sync** and **ad-hoc sharing** with groups. The file-based provider implements the same contract as PinboardService and LocalBookmarkService.'
