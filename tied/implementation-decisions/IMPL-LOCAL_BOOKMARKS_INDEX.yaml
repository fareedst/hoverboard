IMPL-LOCAL_BOOKMARKS_INDEX:
  name: Local Bookmarks Index Implementation
  status: Active
  cross_references: []
  rationale:
    why: See detail file
    problems_solved: []
    benefits: []
  implementation_approach:
    summary: See detail file
    details:
      - 'Time column: toolbar selects **Time column** (Create time | Last updated) and **Time format** (Absolute | Age); single Time column shows b[timeColumnSource] ?? b.time; formatTimeAbsolute (YYYY-MM-DD HH:mm:ss) or formatTimeAge (two largest units); compare() uses timeColumnSource when sortKey === ''time''. Module bookmarks-table-time.js exports formatters; unit tests in bookmarks-table-time.test.js.'
      - 'Default at page load [REQ-LOCAL_BOOKMARKS_INDEX] [REQ-BOOKMARK_CREATE_UPDATE_TIMES]: Time column = Last updated, Time format = Age; initial sort is by last-updated descending with age displayed.'
  code_locations:
    files:
      - src/ui/bookmarks-table/bookmarks-table.html
      - src/ui/bookmarks-table/bookmarks-table.js
      - src/ui/bookmarks-table/bookmarks-table-time.js
      - src/ui/bookmarks-table/bookmarks-table.css
      - src/ui/bookmarks-table/bookmarks-table-filter.js
    functions:
      - matchFilters
      - matchStorageFilter
      - renderTableBody
      - updateMoveControlsState
      - moveSelectedToStorage
      - updateSelectAllState
      - onRowSelectChange
  traceability:
    architecture: []
    requirements: []
    tests:
      - 'tests/unit/message-handler-bookmarks-index.test.js (handleGetAggregatedBookmarksForIndex)'
      - 'tests/unit/bookmarks-table-index.test.js (matchStorageFilter)'
      - 'tests/unit/bookmarks-table-time.test.js (formatTimeAbsolute, formatTimeAge)'
    code_annotations:
      - IMPL-LOCAL_BOOKMARKS_INDEX
  related_decisions:
    depends_on: []
    supersedes: []
    see_also: []
  detail_file: implementation-decisions/IMPL-LOCAL_BOOKMARKS_INDEX.yaml
  metadata:
    created:
      date: '2026-02-18'
      author: MCP converter
    last_updated:
      date: '2026-02-18'
      author: MCP converter
      reason: Converted from monolithic
    last_validated:
      date: '2026-02-18'
      validator: MCP converter
      result: pass
  bookmarks_table_page: '`src/ui/bookmarks-table/bookmarks-table.html`, `bookmarks-table.js`, `bookmarks-table-time.js`, `bookmarks-table.css`. **Compact header** (minimal-height banner: logo, Hoverboard, Local Bookmarks Index, subtitle). Toolbar: search + filters; **Time column** toggle (Create time | Last updated) and **Time format** toggle (Absolute | Age). Single **Time** column shows either create-time or most-recent-update-time [REQ-BOOKMARK_CREATE_UPDATE_TIMES]; format is YYYY-MM-DD HH:mm:ss (absolute) or two-largest-units age (e.g. N days O hours). Sort by Time uses the selected time source. Table with **Select** column (checkboxes, select-all), **Storage** column (Local | File | Sync); filter by storage (All | Local | File | Sync); sortable columns; search and filters (tag, toread, private); URL column as links with **external-link indicator** (â†—). **Actions below table** (`.actions-below-table`): Export all / Export displayed / Export selected, and **Move selected to** dropdown + Move button; moveBookmarkToStorage per selected URL; move and Export selected enabled only when selection non-empty. State: selectedUrls Set, timeColumnSource, timeDisplayMode, updateMoveControlsState(), updateSelectAllState(), updateExportButtonState(). All operations client-side on in-memory array except move (message loop).'
  cross-references: ARCH-LOCAL_BOOKMARKS_INDEX, REQ-LOCAL_BOOKMARKS_INDEX, ARCH-STORAGE_INDEX_AND_ROUTER
  entry_point: Popup footer has "Bookmarks index" button (bookmarksIndexBtn); click emits openBookmarksIndex, PopupController.handleOpenBookmarksIndex opens tab. Options footer has "Local bookmarks index" link (bookmarks-index-link); options.js sets href in init() to chrome.runtime.getURL('src/ui/bookmarks-table/bookmarks-table.html').
  localbookmarkservice_getallbookmarks(): Used by getLocalBookmarksForIndex handler and by BookmarkRouter for local slice of aggregated data.
  primary_data: 'On load, the index page sends **getAggregatedBookmarksForIndex**. Message handler calls `bookmarkProvider.getAllBookmarksForIndex()` when available (BookmarkRouter); router aggregates localProvider, fileProvider, and syncProvider getAllBookmarks(), tags each item with `storage: ''local''` | ''file'' | ''sync'', returns merged list sorted by time desc. Fallback: page sends **getLocalBookmarksForIndex** and tags each item with `storage: ''local''`.'
  related:
    - IMPL-LOCAL_BOOKMARK_SERVICE (existing local provider)
    - IMPL-BOOKMARK_ROUTER (getAllBookmarksForIndex)
    - ARCH-LOCAL_BOOKMARKS_INDEX, REQ-LOCAL_BOOKMARKS_INDEX, ARCH-STORAGE_INDEX_AND_ROUTER
